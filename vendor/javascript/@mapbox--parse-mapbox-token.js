import r from"base-64";var a={};var e=r;var t={};function parseToken(r){if(t[r])return t[r];var a=r.split(".");var e=a[0];var o=a[1];if(!o)throw new Error("Invalid token");var s=parsePaylod(o);var n={usage:e,user:s.u};has(s,"a")&&(n.authorization=s.a);has(s,"exp")&&(n.expires=1e3*s.exp);has(s,"iat")&&(n.created=1e3*s.iat);has(s,"scopes")&&(n.scopes=s.scopes);has(s,"client")&&(n.client=s.client);has(s,"ll")&&(n.lastLogin=s.ll);has(s,"iu")&&(n.impersonator=s.iu);t[r]=n;return n}function parsePaylod(r){try{return JSON.parse(e.decode(r))}catch(r){throw new Error("Invalid token")}}function has(r,a){return Object.prototype.hasOwnProperty.call(r,a)}a=parseToken;var o=a;export default o;

